<p>We will be writing a hello world generator,
which says hello in different programming languages.
Let's define those modules first.</p>

<p><code>lang/ruby.js</code></p>

<div class="highlight"><pre><code class="js"><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;#!ruby&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;puts &quot;Hello, #{&#39;</span> <span class="o">+</span> <span class="nx">msg</span> <span class="o">+</span> <span class="s1">&#39;}&quot;&#39;</span>
<span class="p">);</span>
</code></pre>
</div>


<p><code>lang/js.js</code></p>

<div class="highlight"><pre><code class="js"><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;(function(console) {&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;    console.log(&quot;Hello&quot;, msg);&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;})(window.console || {&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;    log: function() {}&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;});&#39;</span>
<span class="p">);</span>
</code></pre>
</div>


<p><code>lang/lisp.js</code></p>

<div class="highlight"><pre><code class="js"><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span>
    <span class="s1">&#39;(print &quot;Hello, &#39;</span> <span class="o">+</span> <span class="nx">string</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;\\&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span>
<span class="p">);</span>
</code></pre>
</div>




<div class="highlight"><pre><code class="html"><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;pre</span> <span class="na">id=</span><span class="s">&quot;output&quot;</span> <span class="na">data-lang=</span><span class="s">&quot;ruby&quot;</span><span class="nt">&gt;&lt;/pre&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;sea.js&quot;</span> <span class="na">data-main=</span><span class="s">&quot;./generator&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>


<p>the generator should be able to perform these tasks, in specific order:</p>

<ol>
<li>read <code>@data-lang</code> from <code>pre</code> tag.</li>
<li>determine the corresponding language module, and get the result.</li>
<li>shove the result back into the <code>pre</code> tag.</li>
</ol>


<div class="highlight"><pre><code class="js"><span class="nx">seajs</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;./util/html&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">HTMLUtil</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">pre</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">),</span>
        <span class="nx">lang</span> <span class="o">=</span> <span class="nx">pre</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;data-lang&#39;</span><span class="p">),</span>
        <span class="nx">res</span><span class="p">;</span>

    <span class="nx">seajs</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;./lang/&#39;</span> <span class="o">+</span> <span class="nx">lang</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lang</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">res</span> <span class="o">=</span> <span class="nx">lang</span><span class="p">.</span><span class="nx">hello</span><span class="p">();</span>
    <span class="p">});</span>

    <span class="nx">pre</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">HTMLUtil</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
</div>


<p>Now back to the problem raised in the begginning. We can solve it
with the knowledge of SeaJS so far. Every page should have one and only one <code>script</code> tag,
which just differs in the <code>@data-main</code> attribute.</p>

<div class="highlight"><pre><code class="html"><span class="c">&lt;!-- page a --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;sea.js&quot;</span> <span class="na">data-main=</span><span class="s">&quot;./page-a&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="c">&lt;!-- page b --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;sea.js&quot;</span> <span class="na">data-main=</span><span class="s">&quot;./page-b&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>
</div>


<p>Those <code>(function(){})();</code> modules can be organized via <code>define</code> in separated files.
use <code>require</code> for inner module inclusion. Then page a, b, c <code>.js</code> files can be written like this.</p>

<div class="highlight"><pre><code class="js"><span class="nx">seajs</span><span class="p">.</span><span class="nx">use</span><span class="p">([</span><span class="s1">&#39;mod1&#39;</span><span class="p">,</span> <span class="s1">&#39;mod2&#39;</span><span class="p">,</span> <span class="s1">&#39;mod3&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ah my awesome code.</span>
<span class="p">});</span>
</code></pre>
</div>



